#include "application.h"
#include "matrix.h"


Application::Application()
{
    exec();
}

void Application::exec()
{
    bool quit = false;
    int option = 0;

    //???? ?????? ????? ???????, ? ???????? ????? ????????????? ????? ?????. ? ?????
    number** mat;

    //??????? ?????? ?????? Matrix - ???????? ???????????
    Matrix matrix;

    while (quit == false) {
        mainMenu();

        std::cin >> option;

        switch(option)
        {
        case(1):
            matrix.setSize();
            matrix.setValues();
            break;
        case(2):
            //??????? ????? ???????, ????? ????????? ???????? ??? ??????, ? ?? ??? ???????? ????????
            mat = matrix.allocate(matrix.getSize());
            matrix.copy(mat);

            //???????? ????????????
            number det;
            det = matrix.getDet();

            //???? ???????? ????????? - ???? ???????????? (??? ???? ??? 228, ? ?? ???? ??? ??-??????? ???????)
            if (det == 228) {
                matrix.setDet(mat, matrix.getSize());
                det = matrix.getDet();
            }

            //???????? ??????
            matrix.clear(mat, matrix.getSize());

            std::cout << "Determinant = " << det <<std::endl;
            break;
        case(3):
            matrix.transpose();
            break;
        case(4):
            //??????? ????? ???????, ????? ????????? ???????? ??? ??????, ? ?? ??? ???????? ????????
            mat = matrix.allocate(matrix.getSize());
            matrix.copy(mat);

            //???????? ????
            number rank;
            rank = matrix.getRank();

            //???? ???????? ????????? - ???? ????
            if (rank == -1) {
                matrix.setRank(mat, matrix.getSize());
                rank = matrix.getRank();
            }

            //??????? ??????
            matrix.clear(mat, matrix.getSize());

            std::cout << "Rank = " << rank << std::endl;
            break;
        case(5):
            matrix.print();
            break;
        case(6):
            quit = true;
        }

    }
}

void Application::mainMenu()
{
    std::cout << "==============================" << std::endl;
    std::cout << "1) Edit matrix data" << std::endl;
    std::cout << "2) Calculate the matrix determinant" << std::endl;
    std::cout << "3) Transpose the matrix" << std::endl;
    std::cout << "4) Calculate the matrix rank" << std::endl;
    std::cout << "5) Matrix output" << std::endl;
    std::cout << "6) Exit" << std::endl;
    std::cout << "==============================" << std::endl;
}
